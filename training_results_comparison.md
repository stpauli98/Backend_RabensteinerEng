# Training Results - Session Comparison Data

**Session ID:** `session_10bf0746-295d-4e18-88f5-c029fd1daf0e`
**UUID:** `e20453bd-06c9-4f2a-a45c-63ff9e05e8ae`
**Date:** 2026-01-30

---

## Model Configuration

```python
MODEL_CONFIG = {
    'MODE': 'Dense',
    'LAY': 3,           # broj skrivenih slojeva
    'N': 512,           # neurona po sloju
    'EP': 20,           # maksimalni broj epoha
    'ACTF': 'relu',
    'K': 3,
    'KERNEL': 'rbf',
    'C': 1,
    'EPSILON': 0.1,
    'random_dat': False
}
```

---

## Training Split

| Parameter | Value |
|-----------|-------|
| Train | 70% (74,391 samples) |
| Validation | 20% (21,255 samples) |
| Test | 10% (10,627 samples) |
| **Total** | **106,273 samples** |

---

## Input Files Configuration

### 1. load_grid [kW]

| Parameter | Value |
|-----------|-------|
| Type | input |
| Datenform | Historische Daten |
| Datenanpassung | Lineare Interpolation |
| Skalierung | ja |
| Skalierung Min | 0.0 |
| Skalierung Max | 1.0 |
| Zeithorizont Start | -24.0 h |
| Zeithorizont End | 0.0 h |
| Zeitschrittweite | 15 min |
| Data Min | 0 |
| Data Max | 1195.31 |

### 2. t_out

| Parameter | Value |
|-----------|-------|
| Type | input |
| Datenform | Historische Daten |
| Datenanpassung | Lineare Interpolation |
| Skalierung | ja |
| Skalierung Min | 0.0 |
| Skalierung Max | 1.0 |
| Zeithorizont Start | -24.0 h |
| Zeithorizont End | 0.0 h |
| Zeitschrittweite | 15 min |
| Data Min | -10.4 |
| Data Max | 37 |

### 3. t_out_fcst [°C]

| Parameter | Value |
|-----------|-------|
| Type | input |
| Datenform | Historische Daten |
| Datenanpassung | Lineare Interpolation |
| Skalierung | ja |
| Skalierung Min | 0.0 |
| Skalierung Max | 1.0 |
| Zeithorizont Start | **0.0 h** (forecast) |
| Zeithorizont End | **24.0 h** |
| Zeitschrittweite | 15 min |
| Data Min | -10.4 |
| Data Max | 37 |

---

## Output File Configuration

### load_grid2 [kW]

| Parameter | Value |
|-----------|-------|
| Type | output |
| Datenform | Historische Daten |
| Datenanpassung | Lineare Interpolation |
| Skalierung | ja |
| Skalierung Min | 0.0 |
| Skalierung Max | 1.0 |
| Zeithorizont Start | 0.0 h |
| Zeithorizont End | 24.0 h |
| Zeitschrittweite | 15 min |
| Data Min | 0 |
| Data Max | 1195.31 |

---

## Time Components Configuration

| Component | Active | Skalierung | Min | Max | TH Start | TH End |
|-----------|--------|------------|-----|-----|----------|--------|
| Jahr (Y) | ✅ | ja | 0 | 1 | -24h | 0h |
| Monat (M) | ❌ | - | - | - | - | - |
| Woche (W) | ✅ | ja | 0 | 1 | -24h | 0h |
| Tag (D) | ✅ | ja | 0 | 1 | -24h | 0h |
| Feiertag | ❌ | - | - | - | - | - |

**Time Components in Data:** Y_sin, Y_cos, W_sin, W_cos, D_sin, D_cos

---

## Array Dimensions

```python
# Input array (3D)
X_shape = (106273, 97, 9)
# - 106273 samples
# - 97 timesteps (24h / 15min = 96 + 1)
# - 9 features (3 files + 6 time components)

# Output array (3D)
y_shape = (106273, 97, 1)
# - 1 output feature (load_grid2)

# Combined arrays (2D) - used for scaler fitting
i_combined_array_shape = (10308481, 9)  # 106273 * 97 = 10308481
o_combined_array_shape = (10308481, 1)
```

---

## Feature Lists

```python
INPUT_FEATURES = [
    'load_grid [kW]',
    't_out',
    't_out_fcst [°C]',
    'Y_sin',
    'Y_cos',
    'W_sin',
    'W_cos',
    'D_sin',
    'D_cos'
]

OUTPUT_FEATURES = [
    'load_grid2 [kW]'
]
```

---

## Scalers Parameters

### Input Scalers

| Index | Feature | data_min | data_max | scale_ | min_ |
|-------|---------|----------|----------|--------|------|
| 0 | load_grid [kW] | 0.0 | 1195.31 | 0.0008366031 | 0.0 |
| 1 | t_out | -10.4 | 37.0 | 0.0210970464 | 0.2194092827 |
| 2 | t_out_fcst [°C] | -10.4 | 37.0 | 0.0210970464 | 0.2194092827 |
| 3 | Y_sin | -1.0 | 1.0 | 0.5 | 0.5 |
| 4 | Y_cos | -1.0 | 1.0 | 0.5 | 0.5 |
| 5 | W_sin | -1.0 | 1.0 | 0.5 | 0.5 |
| 6 | W_cos | -1.0 | 1.0 | 0.5 | 0.5 |
| 7 | D_sin | -1.0 | 1.0 | 0.5 | 0.5 |
| 8 | D_cos | -1.0 | 1.0 | 0.5 | 0.5 |

### Output Scalers

| Index | Feature | data_min | data_max | scale_ | min_ |
|-------|---------|----------|----------|--------|------|
| 0 | load_grid2 [kW] | 0.0 | 1195.31 | 0.0008366031 | 0.0 |

### Scaling Formulas

```python
# MinMaxScaler formula
scaled_value = (original_value - data_min) / (data_max - data_min) * (feature_max - feature_min) + feature_min

# Simplified (when feature_range = (0, 1))
scaled_value = (original_value * scale_) + min_
original_value = (scaled_value - min_) / scale_
```

---

## i_combined_array Sample Values (Scaled)

**First 10 rows:**

| Row | load_grid | t_out | t_out_fcst | Y_sin | Y_cos | W_sin | W_cos | D_sin | D_cos |
|-----|-----------|-------|------------|-------|-------|-------|-------|-------|-------|
| 0 | 0.479198 | 0.246835 | 0.246835 | 0.489249 | 0.999884 | 0.987464 | 0.388740 | 0.500000 | 1.000000 |
| 1 | 0.479198 | 0.246835 | 0.246835 | 0.489339 | 0.999886 | 0.986402 | 0.384187 | 0.532702 | 0.998929 |
| 2 | 0.479198 | 0.246835 | 0.248945 | 0.489428 | 0.999888 | 0.985298 | 0.379644 | 0.565263 | 0.995722 |
| 3 | 0.479198 | 0.246835 | 0.245781 | 0.489518 | 0.999890 | 0.984152 | 0.375112 | 0.597545 | 0.990393 |
| 4 | 0.479198 | 0.246835 | 0.242616 | 0.489608 | 0.999892 | 0.982963 | 0.370590 | 0.629410 | 0.982963 |
| 5 | 0.479198 | 0.246835 | 0.236287 | 0.489697 | 0.999894 | 0.981732 | 0.366081 | 0.660720 | 0.973465 |
| 6 | 0.479198 | 0.246835 | 0.234177 | 0.489787 | 0.999896 | 0.980459 | 0.361582 | 0.691342 | 0.961940 |
| 7 | 0.479198 | 0.246835 | 0.233122 | 0.489876 | 0.999898 | 0.979143 | 0.357096 | 0.721144 | 0.948436 |
| 8 | 0.479198 | 0.246835 | 0.232068 | 0.489966 | 0.999899 | 0.977786 | 0.352622 | 0.750000 | 0.933013 |
| 9 | 0.479198 | 0.246835 | 0.229958 | 0.490056 | 0.999901 | 0.976388 | 0.348162 | 0.777785 | 0.915735 |

---

## o_combined_array Sample Values (Scaled)

**First 10 rows:**

| Row | load_grid2 [kW] |
|-----|-----------------|
| 0 | 0.479198 |
| 1 | 0.439702 |
| 2 | 0.383583 |
| 3 | 0.464775 |
| 4 | 0.389481 |
| 5 | 0.410237 |
| 6 | 0.330475 |
| 7 | 0.345735 |
| 8 | 0.512946 |
| 9 | 0.395663 |

---

## i_combined_array Statistics (Scaled)

| Index | Feature | Min | Max | Mean | Std |
|-------|---------|-----|-----|------|-----|
| 0 | load_grid [kW] | 0.000000 | 1.000000 | 0.328873 | 0.205440 |
| 1 | t_out | 0.000000 | 1.000000 | 0.448777 | 0.186681 |
| 2 | t_out_fcst [°C] | 0.000000 | 1.000000 | 0.448624 | 0.186911 |
| 3 | Y_sin | 0.000000 | 1.000000 | 0.500425 | 0.351787 |
| 4 | Y_cos | 0.000000 | 1.000000 | 0.505060 | 0.355275 |
| 5 | W_sin | 0.000000 | 1.000000 | 0.500185 | 0.353477 |
| 6 | W_cos | 0.000000 | 1.000000 | 0.499616 | 0.353629 |
| 7 | D_sin | 0.000000 | 1.000000 | 0.500000 | 0.353553 |
| 8 | D_cos | 0.000000 | 1.000000 | 0.500000 | 0.353553 |

---

## o_combined_array Statistics (Scaled)

| Index | Feature | Min | Max | Mean | Std |
|-------|---------|-----|-----|------|-----|
| 0 | load_grid2 [kW] | 0.000000 | 1.000000 | 0.329022 | 0.205622 |

---

## Test Data Arrays

### Summary

| Array | Shape | Min | Max |
|-------|-------|-----|-----|
| X (scaled) | (10627, 97, 9) | 0.000000 | 1.000000 |
| X_orig (original) | (10627, 97, 9) | -10.400000 | 1154.880000 |
| y (scaled) | (10627, 97, 1) | 0.002309 | 0.966176 |
| y_orig (original) | (10627, 97, 1) | 2.760000 | 1154.880000 |

---

## X_orig Sample Values (Original)

**Sample [0], First 5 timesteps, All features:**

| TS | load_grid [kW] | t_out [°C] | t_out_fcst [°C] | Y_sin | Y_cos | W_sin | W_cos | D_sin | D_cos |
|----|----------------|------------|-----------------|-------|-------|-------|-------|-------|-------|
| 0 | 197.17 | 18.70 | 17.30 | -0.9870 | -0.1606 | -0.6663 | -0.7456 | 0.9239 | -0.3827 |
| 1 | 296.70 | 18.90 | 17.55 | -0.9871 | -0.1604 | -0.6733 | -0.7394 | 0.8969 | -0.4423 |
| 2 | 219.23 | 18.70 | 17.60 | -0.9871 | -0.1602 | -0.6802 | -0.7331 | 0.8660 | -0.5000 |
| 3 | 217.72 | 20.15 | 17.75 | -0.9871 | -0.1600 | -0.6870 | -0.7267 | 0.8315 | -0.5556 |
| 4 | 147.63 | 20.50 | 18.20 | -0.9871 | -0.1599 | -0.6938 | -0.7202 | 0.7934 | -0.6088 |

---

## X (Scaled) Sample Values

**Sample [0], First 5 timesteps, All features:**

| TS | load_grid | t_out | t_out_fcst | Y_sin | Y_cos | W_sin | W_cos | D_sin | D_cos |
|----|-----------|-------|------------|-------|-------|-------|-------|-------|-------|
| 0 | 0.164953 | 0.613924 | 0.584388 | 0.006488 | 0.419713 | 0.166827 | 0.127179 | 0.961940 | 0.308658 |
| 1 | 0.248220 | 0.618143 | 0.589662 | 0.006474 | 0.419801 | 0.163355 | 0.130310 | 0.948436 | 0.278856 |
| 2 | 0.183408 | 0.613924 | 0.590717 | 0.006459 | 0.419890 | 0.159914 | 0.133474 | 0.933013 | 0.250000 |
| 3 | 0.182145 | 0.644515 | 0.593882 | 0.006445 | 0.419978 | 0.156502 | 0.136670 | 0.915735 | 0.222215 |
| 4 | 0.123508 | 0.651899 | 0.603376 | 0.006431 | 0.420066 | 0.153119 | 0.139897 | 0.896677 | 0.195619 |

---

## X (Scaled) - Sample [0], Feature 0 (load_grid), All 97 timesteps

```python
[0.164953, 0.248220, 0.183408, 0.182145, 0.123508, 0.158729, 0.101304, 0.085994,
 0.060729, 0.075219, 0.105571, 0.071948, 0.114648, 0.057993, 0.052145, 0.063481,
 0.060428, 0.055258, 0.055299, 0.098359, 0.152329, 0.161473, 0.096720, 0.075018,
 0.062051, 0.094653, 0.089433, 0.148464, 0.123541, 0.072651, 0.077938, 0.059733,
 0.039513, 0.080247, 0.103329, 0.117459, 0.124612, 0.061306, 0.072768, 0.109821,
 0.140382, 0.117325, 0.160603, 0.141695, 0.079745, 0.155140, 0.148388, 0.155558,
 0.208055, 0.148405, 0.102400, 0.100108, 0.109980, 0.107470, 0.144757, 0.163581,
 0.117074, 0.112163, 0.120697, 0.075353, 0.072876, 0.080749, 0.081979, 0.132008,
 0.136274, 0.090236, 0.064159, 0.043487, 0.074391, 0.087643, 0.120513, 0.168584,
 0.120990, 0.061992, 0.072851, 0.078214, 0.113569, 0.132685, 0.164125, 0.239135,
 0.136483, 0.171169, 0.174858, 0.126971, 0.095515, 0.106449, 0.114171, 0.144297,
 0.106533, 0.240933, 0.274180, 0.221424, 0.101396, 0.160009, 0.058989, 0.074500,
 0.124336]
```

---

## X_orig - Sample [0], Feature 0 (load_grid [kW]), All 97 timesteps

```python
[197.17, 296.70, 219.23, 217.72, 147.63, 189.73, 121.09, 102.79, 72.59, 89.91,
 126.19, 86.00, 137.04, 69.32, 62.33, 75.88, 72.23, 66.05, 66.10, 117.57,
 182.08, 193.01, 115.61, 89.67, 74.17, 113.14, 106.90, 177.46, 147.67, 86.84,
 93.16, 71.40, 47.23, 95.92, 123.51, 140.40, 148.95, 73.28, 86.98, 131.27,
 167.80, 140.24, 191.97, 169.37, 95.32, 185.44, 177.37, 185.94, 248.69, 177.39,
 122.40, 119.66, 131.46, 128.46, 173.03, 195.53, 139.94, 134.07, 144.27, 90.07,
 87.11, 96.52, 97.99, 157.79, 162.89, 107.86, 76.69, 51.98, 88.92, 104.76,
 144.05, 201.51, 144.62, 74.10, 87.08, 93.49, 135.75, 158.60, 196.18, 285.84,
 163.14, 204.60, 209.01, 151.77, 114.17, 127.24, 136.47, 172.48, 127.34, 287.99,
 327.73, 264.67, 121.20, 191.26, 70.51, 89.05, 148.62]
```

---

## y_orig Sample Values (Original kW)

**First 5 samples, first 10 timesteps:**

| Sample | TS0 | TS1 | TS2 | TS3 | TS4 | TS5 | TS6 | TS7 | TS8 | TS9 |
|--------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 0 | 148.62 | 151.98 | 232.98 | 244.40 | 109.04 | 115.13 | 154.97 | 105.38 | 100.55 | 129.35 |
| 1 | 151.98 | 232.98 | 244.40 | 109.04 | 115.13 | 154.97 | 105.38 | 100.55 | 129.35 | 83.63 |
| 2 | 232.98 | 244.40 | 109.04 | 115.13 | 154.97 | 105.38 | 100.55 | 129.35 | 83.63 | 52.66 |
| 3 | 244.40 | 109.04 | 115.13 | 154.97 | 105.38 | 100.55 | 129.35 | 83.63 | 52.66 | 91.32 |
| 4 | 109.04 | 115.13 | 154.97 | 105.38 | 100.55 | 129.35 | 83.63 | 52.66 | 91.32 | 76.58 |

**First 5 samples, last 10 timesteps:**

| Sample | TS87 | TS88 | TS89 | TS90 | TS91 | TS92 | TS93 | TS94 | TS95 | TS96 |
|--------|------|------|------|------|------|------|------|------|------|------|
| 0 | 221.07 | 117.19 | 143.02 | 112.90 | 117.94 | 134.73 | 103.29 | 96.71 | 70.81 | 141.61 |
| 1 | 117.19 | 143.02 | 112.90 | 117.94 | 134.73 | 103.29 | 96.71 | 70.81 | 141.61 | 151.66 |
| 2 | 143.02 | 112.90 | 117.94 | 134.73 | 103.29 | 96.71 | 70.81 | 141.61 | 151.66 | 185.60 |
| 3 | 112.90 | 117.94 | 134.73 | 103.29 | 96.71 | 70.81 | 141.61 | 151.66 | 185.60 | 275.85 |
| 4 | 117.94 | 134.73 | 103.29 | 96.71 | 70.81 | 141.61 | 151.66 | 185.60 | 275.85 | 255.72 |

---

## y (Scaled) - Sample [0], All 97 timesteps

```python
[0.124336, 0.127147, 0.194912, 0.204466, 0.091223, 0.096318, 0.129648, 0.088161,
 0.084120, 0.108215, 0.069965, 0.044056, 0.076399, 0.064067, 0.083091, 0.104693,
 0.112406, 0.118681, 0.114573, 0.203838, 0.226284, 0.109955, 0.149693, 0.165263,
 0.167053, 0.154060, 0.065414, 0.041454, 0.067656, 0.074525, 0.088203, 0.075554,
 0.119726, 0.062252, 0.076599, 0.109336, 0.180004, 0.122897, 0.120412, 0.185759,
 0.144097, 0.155123, 0.203152, 0.235102, 0.221917, 0.195899, 0.089868, 0.058545,
 0.143912, 0.128117, 0.087417, 0.082548, 0.130836, 0.102701, 0.100183, 0.112967,
 0.057726, 0.048339, 0.033673, 0.085777, 0.118697, 0.149392, 0.203713, 0.110448,
 0.059064, 0.084070, 0.077829, 0.080188, 0.102609, 0.128352, 0.064276, 0.055157,
 0.037890, 0.067740, 0.117342, 0.083635, 0.104349, 0.141737, 0.107922, 0.099154,
 0.088529, 0.128678, 0.190302, 0.124068, 0.235587, 0.279300, 0.252947, 0.184948,
 0.098042, 0.119651, 0.094452, 0.098669, 0.112716, 0.086413, 0.080908, 0.059240,
 0.118471]
```

---

## y_orig - Sample [0], All 97 timesteps (kW)

```python
[148.62, 151.98, 232.98, 244.40, 109.04, 115.13, 154.97, 105.38, 100.55, 129.35,
 83.63, 52.66, 91.32, 76.58, 99.32, 125.14, 134.36, 141.86, 136.95, 243.65,
 270.48, 131.43, 178.93, 197.54, 199.68, 184.15, 78.19, 49.55, 80.87, 89.08,
 105.43, 90.31, 143.11, 74.41, 91.56, 130.69, 215.16, 146.90, 143.93, 222.04,
 172.24, 185.42, 242.83, 281.02, 265.26, 234.16, 107.42, 69.98, 172.02, 153.14,
 104.49, 98.67, 156.39, 122.76, 119.75, 135.03, 69.00, 57.78, 40.25, 102.53,
 141.88, 178.57, 243.50, 132.02, 70.60, 100.49, 93.03, 95.85, 122.65, 153.42,
 76.83, 65.93, 45.29, 80.97, 140.26, 99.97, 124.73, 169.42, 129.00, 118.52,
 105.82, 153.81, 227.47, 148.30, 281.60, 333.85, 302.35, 221.07, 117.19, 143.02,
 112.90, 117.94, 134.73, 103.29, 96.71, 70.81, 141.61]
```

---

## Evaluation Metrics

```
MAE:  61.53 kW
MAPE: 15.39%
RMSE: 77.35 kW
```

---

## Notes

- **Timestep 0** in input (X) corresponds to **-24h** from reference time
- **Timestep 96** in input (X) corresponds to **0h** (reference time)
- **Timestep 0** in output (y) corresponds to **0h** (reference time)
- **Timestep 96** in output (y) corresponds to **+24h** from reference time
- Time components (Y_sin, Y_cos, etc.) have original range [-1, 1] scaled to [0, 1]
- All scalers use MinMaxScaler with feature_range=(0.0, 1.0)
